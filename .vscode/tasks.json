{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "[BUILD]",
            "type": "shell",
            "command": "./build.sh",
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Build the projects release and debug binaries. Cleans previous builds."
        },
        {
            "label": "[MINIMAL BUILD]",
            "type": "shell",
            "command": "./build.sh -minimal",
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Builds the projects Linux Release binary."
        },
        {
            "label": "[BUILD + TEST]",
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "dependsOn": [
                "[BUILD]", 
                "[TEST]"
            ],
            "dependsOrder": "sequence",
            "problemMatcher": [],
            "detail": "Build with JSON validation and run Tests. Stops on first failure."
        },
        {
            "label": "[TEST]",
            "type": "shell",
            "command": "python ./Scripts/Validation/json_syntax_and_references.py && python Scripts/TestingSuite.py --stop --verbose && cd ..",
            "group": {
                "kind": "test",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Build with JSON validation and run Tests. Stops on first failure."
        },
        {
            "label": "[PROFILING] On small gravity test",
            "type": "shell",
            "command": "sudo sysctl -w kernel.perf_event_paranoid=-1 ; sudo sysctl -w kernel.kptr_restrict=0 && perf record --no-inherit -g -- ./bin/Nebulite_Debug task TaskFiles/Benchmarks/spawn_constantly.nebs ; hotspot perf.data",
            "group": {
                "kind": "test",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Run a debug Task on the Debug binary with perf to profile performance. Shows results both in CLI with perf and in a GUI using hotspot"
        },
        {
            "label": "[PROFILING] On large gravity test",
            "type": "shell",
            "command": "sudo sysctl -w kernel.perf_event_paranoid=-1 ; sudo sysctl -w kernel.kptr_restrict=0  ; perf record --no-inherit -F 99 -g -- ./bin/Nebulite_Debug task TaskFiles/Benchmarks/gravity_XL.nebs ; hotspot perf.data",
            "group": {
                "kind": "test",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Run a debug Task on the Debug binary with perf to profile performance. Shows results both in CLI with perf and in a GUI using hotspot."
        },
        {
            "label": "[MEMORY] Check for memory leaks",
            "type": "shell",
            "command": "rm -rf massif_output.out ; ulimit -n 32768 && valgrind --tool=massif --massif-out-file=massif_output.out ./bin/Nebulite_Debug task TaskFiles/Debugging/vscode_memleak_test.nebs && massif-visualizer massif_output.out",
            "group": {
                "kind": "test",
                "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Run a memory leak check using Valgrind's Massif tool."
        },
        {
            "label": "Install language extension",
            "type": "shell",
            "command": "Languages/nebs/nebulite-script-vscode/build-and-install.sh",
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "Build and install the VSCode language extension for Nebulite Script."
        }
    ]
}